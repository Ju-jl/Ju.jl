<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utilities · Ju.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Ju.jl logo"/></a><h1>Ju.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../tutorial/">Tutorial</a></li><li><a class="toctext" href="../interfaces/">Interfaces</a></li><li><a class="toctext" href="../components/">Components</a></li><li class="current"><a class="toctext" href>Utilities</a><ul class="internal"><li><a class="toctext" href="#Core-1">Core</a></li><li><a class="toctext" href="#Callbasks-1">Callbasks</a></li><li><a class="toctext" href="#Decays-1">Decays</a></li><li><a class="toctext" href="#Iterators-1">Iterators</a></li><li><a class="toctext" href="#Helper-Functions-1">Helper Functions</a></li><li><a class="toctext" href="#Others-1">Others</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Utilities</a></li></ul><a class="edit-page" href="https://github.com/Ju-jl/Ju.jl/blob/master/docs/src/utilities.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Utilities</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Utilities-1" href="#Utilities-1">Utilities</a></h1><ul><li><a href="#Utilities-1">Utilities</a></li><ul><li><a href="#Core-1">Core</a></li><li><a href="#Callbasks-1">Callbasks</a></li><li><a href="#Decays-1">Decays</a></li><li><a href="#Iterators-1">Iterators</a></li><li><a href="#Helper-Functions-1">Helper Functions</a></li><li><a href="#Others-1">Others</a></li></ul></ul><h2><a class="nav-anchor" id="Core-1" href="#Core-1">Core</a></h2><p>The most widely used functions while solving RL problems are listed below:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.policy_evaluation!-Tuple{AbstractVApproximator,AbstractPolicy,AbstractDistributionModel}" href="#Ju.policy_evaluation!-Tuple{AbstractVApproximator,AbstractPolicy,AbstractDistributionModel}"><code>Ju.policy_evaluation!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">policy_evaluation!(V::AbstractVApproximator, π::AbstractPolicy, Model::AbstractDistributionModel; γ::Float64=0.9, θ::Float64=1e-4)</code></pre><p>See more details at Section (4.1) on Page 75 of the book <em>Sutton, Richard S., and Andrew G. Barto. Reinforcement learning: An introduction. MIT press, 2018.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/core.jl#L120-L124">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.policy_improvement!-Tuple{AbstractVApproximator,AbstractPolicy,AbstractDistributionModel}" href="#Ju.policy_improvement!-Tuple{AbstractVApproximator,AbstractPolicy,AbstractDistributionModel}"><code>Ju.policy_improvement!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">policy_improvement!(V::AbstractVApproximator, π::AbstractPolicy, Model::AbstractDistributionModel; γ::Float64=0.9)</code></pre><p>See more details at Section (4.2) on Page 76 of the book <em>Sutton, Richard S., and Andrew G. Barto. Reinforcement learning: An introduction. MIT press, 2018.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/core.jl#L139-L143">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.policy_iteration!-Tuple{AbstractVApproximator,AbstractPolicy,AbstractDistributionModel}" href="#Ju.policy_iteration!-Tuple{AbstractVApproximator,AbstractPolicy,AbstractDistributionModel}"><code>Ju.policy_iteration!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">policy_iteration!(V::AbstractVApproximator, π::AbstractPolicy, Model::AbstractDistributionModel; γ::Float64=0.9, θ::Float64=1e-4, max_iter=typemax(Int))</code></pre><p>See more details at Section (4.3) on Page 80 of the book <em>Sutton, Richard S., and Andrew G. Barto. Reinforcement learning: An introduction. MIT press, 2018.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/core.jl#L159-L163">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.train!-Tuple{Any,Any}" href="#Ju.train!-Tuple{Any,Any}"><code>Ju.train!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">train!(env, agent; callbacks::Tuple{Vararg{&lt;:Function}}=(stop_at_step(1),))</code></pre><p>Train an <code>agent</code> in <code>env</code>. By default <code>callbacks</code> is <code>(stop_at_step(1),)</code>. So it will only train one step forward.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/core.jl#L3-L8">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.train!-Union{Tuple{N}, Tuple{AbstractSyncEnvironment{Tss,Tas,N} where Tas where Tss,Tuple{Vararg{Agent{#s62,#s63,Tpp} where Tpp&lt;:Function where #s63&lt;:(AbstractTurnBuffer{(:state, :action, :reward, :isdone),types} where types) where #s62&lt;:AbstractLearner,N}}}} where N" href="#Ju.train!-Union{Tuple{N}, Tuple{AbstractSyncEnvironment{Tss,Tas,N} where Tas where Tss,Tuple{Vararg{Agent{#s62,#s63,Tpp} where Tpp&lt;:Function where #s63&lt;:(AbstractTurnBuffer{(:state, :action, :reward, :isdone),types} where types) where #s62&lt;:AbstractLearner,N}}}} where N"><code>Ju.train!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">train!(env::AbstractSyncEnvironment{Tss, Tas, N} where {Tss, Tas},
       agents::Tuple{Vararg{&lt;:Agent{&lt;:AbstractLearner, &lt;:SARDSBuffer}, N}};
       callbacks::Tuple{Vararg{&lt;:Function}}=(stop_at_step(1),)) where N</code></pre><p>TODO: Add an <code>AgentManager</code> struct to better organize <code>agents</code>.</p><p>For sync environments of mulit-agents, it becomes much more complicated compared to the single agent environments. Here is an implementation for one of the most common cases. Each agent take an action alternately. In every step, all agents may observe partial/complete information of the environment from their own perspective.</p><p>You may consider to overwrite this function according to the problem you want to solve.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/core.jl#L47-L59">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.value_iteration!-Tuple{AbstractVApproximator,AbstractDistributionModel}" href="#Ju.value_iteration!-Tuple{AbstractVApproximator,AbstractDistributionModel}"><code>Ju.value_iteration!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">value_iteration!(V::AbstractVApproximator, Model::AbstractDistributionModel; γ::Float64=0.9, θ::Float64=1e-4, max_iter=typemax(Int))</code></pre><p>See more details at Section (4.4) on Page 83 of the book <em>Sutton, Richard S., and Andrew G. Barto. Reinforcement learning: An introduction. MIT press, 2018.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/core.jl#L172-L176">source</a></section><h2><a class="nav-anchor" id="Callbasks-1" href="#Callbasks-1">Callbasks</a></h2><p>The callbacks are used in <a href="#Ju.train!-Tuple{Any,Any}"><code>train!</code></a>. Here are some of the predefined callbacks:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.rewards_of_each_episode-Tuple{}" href="#Ju.rewards_of_each_episode-Tuple{}"><code>Ju.rewards_of_each_episode</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>A callback(closure) which will record the total reward of each episode. Only support single agent yet.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/callbacks.jl#L62-L65">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.steps_per_episode-Tuple{}" href="#Ju.steps_per_episode-Tuple{}"><code>Ju.steps_per_episode</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>A callback(closure) which will record the length of each episode</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/callbacks.jl#L45">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.stop_at_episode" href="#Ju.stop_at_episode"><code>Ju.stop_at_episode</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">stop_at_episode(n::Int, is_show_progress::Bool=true)</code></pre><p>Return a function, which will return false after <code>n</code> episodes. <code>isend(env)</code> is used to check if it is the end of an episode. <code>is_show_progress</code> will control whether print the progress meter or not.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/callbacks.jl#L21-L27">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.stop_at_step" href="#Ju.stop_at_step"><code>Ju.stop_at_step</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">stop_at_step(n::Int, is_show_progress::Bool=true)</code></pre><p>Return a function, which will return false after been called <code>n</code> times. <code>is_show_progress</code> will control whether print the progress meter or not.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/callbacks.jl#L5-L10">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.stop_when_done-Tuple{Any,Any}" href="#Ju.stop_when_done-Tuple{Any,Any}"><code>Ju.stop_when_done</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return false when encountered an end of an episode</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/callbacks.jl#L42">source</a></section><h2><a class="nav-anchor" id="Decays-1" href="#Decays-1">Decays</a></h2><p>Decays are used to efficiently calculate some variables which change based on time step.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.cached_inverse_decay-Tuple{}" href="#Ju.cached_inverse_decay-Tuple{}"><code>Ju.cached_inverse_decay</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">cached_inverse_decay()</code></pre><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; f = cached_inverse_decay();

julia&gt; f(:a) # cached!
1.0

julia&gt; f(:a) # call again
0.5

julia&gt; f(:a) # call again
0.3333333333333333

julia&gt; f(:b) # a new cache
1.0</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/decays.jl#L92-L111">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.cached_sample_avg-Tuple{}" href="#Ju.cached_sample_avg-Tuple{}"><code>Ju.cached_sample_avg</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">cached_sample_avg()</code></pre><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; f = cached_sample_avg();

julia&gt; f(:a, 3)  # cache :a
3.0

julia&gt; f(:a, 5)  # calculate avg value of  :a (3 + 5) / 2
4.0

julia&gt; f(:a, 8)  # calculate avg value of  :a (3 + 5 + 8) /3
5.333333333333333

julia&gt; f(:b, 0)  # cache another value
0.0</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/decays.jl#L122-L141">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.incrementer-Tuple{}" href="#Ju.incrementer-Tuple{}"><code>Ju.incrementer</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">incrementer(;start=1, step=1)</code></pre><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; f = incrementer();

julia&gt; [f() for _ in 1:3]
3-element Array{Int64,1}:
 1
 2
 3</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/decays.jl#L3-L16">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.inverse_decay-Tuple{}" href="#Ju.inverse_decay-Tuple{}"><code>Ju.inverse_decay</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">inverse_decay()</code></pre><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; f = inverse_decay()
#25 (generic function with 1 method)

julia&gt; [f() for _ in 1:5]
5-element Array{Float64,1}:
 1.0
 0.5
 0.3333333333333333
 0.25
 0.2</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/decays.jl#L41-L57">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.multiplier-Tuple{}" href="#Ju.multiplier-Tuple{}"><code>Ju.multiplier</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">multiplier(;start=1.0, ratio=1.0)</code></pre><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; f = multiplier(ratio=0.9);

julia&gt; [f() for _ in 1:3]
3-element Array{Float64,1}:
 1.0
 0.9
 0.81</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/decays.jl#L22-L35">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.sample_avg-Tuple{}" href="#Ju.sample_avg-Tuple{}"><code>Ju.sample_avg</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">sample_avg()</code></pre><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; f = sample_avg();

julia&gt; f(2)
2.0

julia&gt; f(3) # (2+3)/2
2.5

julia&gt; f(5) # (2+3+5)/3
3.3333333333333335</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/decays.jl#L66-L82">source</a></section><h2><a class="nav-anchor" id="Iterators-1" href="#Iterators-1">Iterators</a></h2><p>Some iterators are very helpful while implementing traditional RL algorithms.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.IsFirstVisit" href="#Ju.IsFirstVisit"><code>Ju.IsFirstVisit</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">IsFirstVisit(itr)</code></pre><p>Return an iterator which signifies whether each element in <code>itr</code> occurs for the first time.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; s = [1,2,3,1,4,2,5];

julia&gt; is_first_visit(s)
7-element Array{Bool,1}:
  true
  true
  true
 false
  true
 false
  true

julia&gt; Iterators.reverse(IsFirstVisit(s))
Base.Iterators.Reverse{IsFirstVisit{Array{Int64,1}}}(IsFirstVisit{Array{Int64,1}}([1, 2, 3, 1, 4, 2, 5]))

julia&gt; collect(Iterators.reverse(IsFirstVisit(s)))
7-element Array{Any,1}:
  true
 false
  true
 false
  true
  true
  true</code></pre><div class="admonition warning"><div class="admonition-title">Warning</div><div class="admonition-text"><p>Although <code>IsFirstVisit</code> supports <code>Iterators.reverse</code>, you should still take care of the memory usage. Internally we will walk through the <code>itr</code> first and calculate the count of each unique element.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/iterators.jl#L104-L140">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.Reductions" href="#Ju.Reductions"><code>Ju.Reductions</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">struct Reductions{T&lt;:Union{NamedTuple{(:init,)}, NamedTuple{()}}, F, I}
    op::F
    itr::I
    kw::T
end</code></pre><p>Construct an iterator to get all the intermediate values while calling <code>reduce(op, itr;kw...)</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/iterators.jl#L19-L27">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.reductions-Tuple{Any,Any}" href="#Ju.reductions-Tuple{Any,Any}"><code>Ju.reductions</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">reductions(op, iter; init)</code></pre><p>Return an Iterator of the intermediate values of the reduction (as per reduce) of <code>iter</code> by <code>op</code>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>You can not apply <code>Iterators.reverse</code> to <code>Reductions</code> (due to time complexity). If you really want to get the reversed <code>Reductions</code>, consider <code>collect</code> first and then call <code>reverse!</code></p></div></div><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; reductions(+, [2,3,4])
3-element Array{Int64,1}:
 2
 5
 9

julia&gt; reductions(+, [2,3,4], init=3)
Reductions{NamedTuple{(:init,),Tuple{Int64}},typeof(+),Array{Int64,1}}(+, [2, 3, 4], (init = 3,))

julia&gt; collect(reductions(+, [2,3,4], init=3))
4-element Array{Any,1}:
  3
  5
  8
 12</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/iterators.jl#L36-L64">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.countmap-Tuple{Any}" href="#StatsBase.countmap-Tuple{Any}"><code>StatsBase.countmap</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>extend the countmap in StatsBase to support general iterator</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/iterators.jl#L6">source</a></section><h2><a class="nav-anchor" id="Helper-Functions-1" href="#Helper-Functions-1">Helper Functions</a></h2><p>Following are some commonly used functions.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.deletefirst!-Tuple{Array{T,1} where T,Any}" href="#Ju.deletefirst!-Tuple{Array{T,1} where T,Any}"><code>Ju.deletefirst!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">deletefirst!(A::Vector, element)</code></pre><p>Find the first <code>element</code> in <code>A</code> and delete it. <code>==</code> is used to compare equality.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/helper_functions.jl#L52-L57">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.findallmax-Tuple{Any}" href="#Ju.findallmax-Tuple{Any}"><code>Ju.findallmax</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">findallmax(A::AbstractArray)</code></pre><p>Like <code>findmax</code>, but all the indices of the maximum value are returned.</p><div class="admonition warning"><div class="admonition-title">Warning</div><div class="admonition-text"><p>All elements of value <code>NaN</code> in <code>A</code> will be ignored, unless all elements are <code>NaN</code>. In that case, the returned maximum value will be <code>NaN</code> and the returned indices will be <code>collect(1:length(A))</code></p></div></div><p>#Examples</p><pre><code class="language-julia-repl">julia&gt; findallmax([-Inf, -Inf, -Inf])
(-Inf, [1, 2, 3])

julia&gt; findallmax([Inf, Inf, Inf])
(Inf, [1, 2, 3])

julia&gt; findallmax([Inf, 0, Inf])
(Inf, [1, 3])

julia&gt; findallmax([0,1,2,1,2,1,0])
(2, [3, 5])</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/helper_functions.jl#L7-L30">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.importance_weight-NTuple{4,Any}" href="#Ju.importance_weight-NTuple{4,Any}"><code>Ju.importance_weight</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">importance_weight(π, b, states, actions)</code></pre><p>Calculate the importance weight between the target policy <code>π</code> and behavior policy <code>b</code> given <code>states</code> and <code>actions</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/helper_functions.jl#L83-L88">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.onehot" href="#Ju.onehot"><code>Ju.onehot</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">onehot(n::Int, x::Int, t::Type=Int; isdense::Bool=true)</code></pre><p>If <code>isdense</code> is <code>false</code>, a <code>SparseArray</code> is returned.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/helper_functions.jl#L62-L66">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.reverse_discounted_rewards-Tuple{Any,Any}" href="#Ju.reverse_discounted_rewards-Tuple{Any,Any}"><code>Ju.reverse_discounted_rewards</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">reverse_discounted_rewards(rewards, γ)</code></pre><p>Given the <code>rewards</code> and discount ratio <code>γ</code>, the discounted reward at each time step in the reversed order is returned. The returned object is of type <a href="#Ju.Reductions"><code>Reductions</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/helper_functions.jl#L75-L80">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.reverse_importance_weights-NTuple{4,Any}" href="#Ju.reverse_importance_weights-NTuple{4,Any}"><code>Ju.reverse_importance_weights</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">reverse_importance_weights(π, b, states, actions)</code></pre><p>Calculate the importance weight at each time step in the <strong>reversed</strong> order between the target policy <code>π</code> and behavior policy <code>b</code> given <code>states</code> and <code>actions</code>.</p><p>The returned object is of type <a href="#Ju.Reductions"><code>Reductions</code></a></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/base/helper_functions.jl#L102-L109">source</a></section><h2><a class="nav-anchor" id="Others-1" href="#Others-1">Others</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.sample" href="#StatsBase.sample"><code>StatsBase.sample</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">sample(b::CircularSARDBuffer, batch_size::Int)</code></pre><p>Sample a random batch of <strong>S</strong>tates, <strong>A</strong>ctions, <strong>R</strong>ewards, is<strong>D</strong>one, next<strong>S</strong>tates, next<strong>A</strong>ctions without replacement of <code>batch_size</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/buffers/circular_turn_buffer.jl#L81-L86">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.CircularArrayBuffer" href="#Ju.CircularArrayBuffer"><code>Ju.CircularArrayBuffer</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">CircularArrayBuffer{E, T, N}</code></pre><p>Using a <code>N</code> dimension Array to simulate a circular buffer of <code>N-1</code> dimensional elements. Here <code>E</code> is the type of element and <code>T</code> is same with the <code>eltype</code> of <code>E</code>. Call <code>eltype(b::CircularArrayBuffer{E,T,N})</code> will return <code>E</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; b = CircularArrayBuffer{Float64}(2)
0-element CircularArrayBuffer{Float64,Float64,1}

julia&gt; push!(b, rand())
1-element CircularArrayBuffer{Float64,Float64,1}:
 0.9709012378596478

julia&gt; push!(b, rand())
2-element CircularArrayBuffer{Float64,Float64,1}:
 0.9709012378596478
 0.4510778027035365

julia&gt; push!(b, rand())
2-element CircularArrayBuffer{Float64,Float64,1}:
 0.4510778027035365
 0.6774251288208646

julia&gt; b = CircularArrayBuffer{Array{Float64,2}}(3, (3,3))
3×3×0 CircularArrayBuffer{Array{Float64,2},Float64,3}

julia&gt; push!(b, randn(3,3))
3×3×1 CircularArrayBuffer{Array{Float64,2},Float64,3}:
[:, :, 1] =
 -0.548592   0.926179  -1.40998
 -0.0888621  0.177208   0.342665
  0.0925987  1.18531    0.962738</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/buffers/circular_array_buffer.jl#L1-L38">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Ju.Tiling" href="#Ju.Tiling"><code>Ju.Tiling</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">Tiling(ranges::NTuple{N, Tr}) where {N, Tr}</code></pre><p>Using a tuple of <code>ranges</code> to simulate a tiling.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; t = Tiling((1:2:5, 10:5:20))
Tiling{2,StepRange{Int64,Int64}}((1:2:5, 10:5:20), [1 3; 2 4])

julia&gt; Ju.encode(t, (2, 12))  # encode into an Int
1

julia&gt; Ju.encode(t, (2, 18))

julia&gt; t2 = t - (1, 3)  # shift a little to get a new Tiling
Tiling{2,StepRange{Int64,Int64}}((0:2:4, 7:5:17), [1 3; 2 4])3</code></pre><p>See also: <a href="../components/#Ju.TilingsV"><code>TilingsV</code></a>, <a href="../components/#Ju.TilingsQ"><code>TilingsQ</code></a></p></div></div><a class="source-link" target="_blank" href="https://github.com/Ju-jl/Ju.jl/blob/8f87f294f0b283b153d21b9078fef50bb628be79/src/approximators/tilings.jl#L3-L23">source</a></section><footer><hr/><a class="previous" href="../components/"><span class="direction">Previous</span><span class="title">Components</span></a></footer></article></body></html>
